{"version":3,"file":"blockREADME.js","names":[],"sources":["../../src/blocks/blockREADME.ts"],"sourcesContent":["import { z } from \"zod\";\n\nimport { base } from \"../base.js\";\n\nfunction printAttributes(attributes: Record<string, number | string>) {\n\treturn Object.entries(attributes)\n\t\t.map(([key, value]) => `${key}=\"${value}\"`)\n\t\t.sort()\n\t\t.join(\" \");\n}\n\nconst zBadge = z.object({\n\talt: z.string(),\n\tcomments: z\n\t\t.object({\n\t\t\tafter: z.string(),\n\t\t\tbefore: z.string(),\n\t\t})\n\t\t.optional(),\n\thref: z.string().optional(),\n\tsrc: z.string(),\n});\n\ntype Badge = z.infer<typeof zBadge>;\n\nexport const blockREADME = base.createBlock({\n\tabout: {\n\t\tname: \"README.md\",\n\t},\n\taddons: {\n\t\tbadges: z.array(zBadge).default([]),\n\t\tdefaultUsage: z.array(z.string()).default([]),\n\t\tnotices: z.array(z.string()).default([]),\n\t\tsections: z.array(z.string()).default([]),\n\t},\n\tproduce({ addons, options }) {\n\t\tconst { badges, defaultUsage, notices, sections } = addons;\n\n\t\tconst explainer =\n\t\t\toptions.documentation.readme.explainer &&\n\t\t\t`\\n${options.documentation.readme.explainer}\\n`;\n\n\t\tconst logo =\n\t\t\toptions.logo &&\n\t\t\t`\\n<img ${printAttributes({ align: \"right\", ...options.logo })}>\\n`;\n\n\t\tconst suffixes = [\n\t\t\t...notices,\n\t\t\toptions.documentation.readme.footnotes,\n\t\t].filter((suffix) => typeof suffix === \"string\");\n\n\t\treturn {\n\t\t\tfiles: {\n\t\t\t\t\"README.md\": `<h1 align=\"center\">${options.title}</h1>\n\n<p align=\"center\">${formatDescription(options.description)}</p>\n\n<p align=\"center\">\n${formatBadges(badges)}\n</p>\n${[logo, explainer].filter(Boolean).join(\"\")}\n## Usage\n\n${options.documentation.readme.usage ?? defaultUsage.join(\"\\n\\n\")}\n\n## Development\n\nSee [\\`.github/CONTRIBUTING.md\\`](./.github/CONTRIBUTING.md), then [\\`.github/DEVELOPMENT.md\\`](./.github/DEVELOPMENT.md).\nThanks! ${options.emoji}\n${[...sections, options.documentation.readme.additional]\n\t.filter(Boolean)\n\t.map((section) => `\\n${section}`)\n\t.join(\"\")}\n${suffixes.length ? `\\n${suffixes.map((suffix) => suffix.trim()).join(\"\\n\\n\")}` : \"\"}`,\n\t\t\t},\n\t\t};\n\t},\n});\n\nfunction badgeSorter(a: Badge, b: Badge) {\n\treturn removeEmojis(a.alt).localeCompare(removeEmojis(b.alt));\n}\n\nfunction formatBadge(badge: Badge) {\n\tconst image = `<img alt=\"${badge.alt}\" src=\"${badge.src}\" />`;\n\tconst tagged = badge.href\n\t\t? `<a href=\"${badge.href}\" target=\"_blank\">${image}</a>`\n\t\t: image;\n\tconst commented = badge.comments\n\t\t? `${badge.comments.before}${tagged}${badge.comments.after}`\n\t\t: tagged;\n\n\treturn `\\t${commented}`;\n}\n\nfunction formatBadges(badges: Badge[]) {\n\treturn [\n\t\t...badges,\n\t\t{\n\t\t\talt: \"ðŸ’ª TypeScript: Strict\",\n\t\t\tsrc: \"https://img.shields.io/badge/%F0%9F%92%AA_typescript-strict-21bb42.svg\",\n\t\t},\n\t]\n\t\t.sort(badgeSorter)\n\t\t.map(formatBadge)\n\t\t.join(\"\\n\");\n}\n\nfunction formatDescription(description: string) {\n\tif (!description.includes(\". \")) {\n\t\treturn description;\n\t}\n\n\treturn \"\\n\\t\" + description.replaceAll(\". \", \".\\n\\t\") + \"\\n\";\n}\n\nfunction removeEmojis(text: string) {\n\treturn text.replaceAll(/\\p{Emoji}/gu, \"\").trim();\n}\n"],"mappings":";;;;AAIA,SAAS,gBAAgB,YAA6C;AACrE,QAAO,OAAO,QAAQ,WAAW,CAC/B,KAAK,CAAC,KAAK,WAAW,GAAG,IAAI,IAAI,MAAM,GAAG,CAC1C,MAAM,CACN,KAAK,IAAI;;AAGZ,MAAM,SAAS,EAAE,OAAO;CACvB,KAAK,EAAE,QAAQ;CACf,UAAU,EACR,OAAO;EACP,OAAO,EAAE,QAAQ;EACjB,QAAQ,EAAE,QAAQ;EAClB,CAAC,CACD,UAAU;CACZ,MAAM,EAAE,QAAQ,CAAC,UAAU;CAC3B,KAAK,EAAE,QAAQ;CACf,CAAC;AAIF,MAAa,cAAc,KAAK,YAAY;CAC3C,OAAO,EACN,MAAM,aACN;CACD,QAAQ;EACP,QAAQ,EAAE,MAAM,OAAO,CAAC,QAAQ,EAAE,CAAC;EACnC,cAAc,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EAC7C,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EACxC,UAAU,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EACzC;CACD,QAAQ,EAAE,QAAQ,WAAW;EAC5B,MAAM,EAAE,QAAQ,cAAc,SAAS,aAAa;EAEpD,MAAM,YACL,QAAQ,cAAc,OAAO,aAC7B,KAAK,QAAQ,cAAc,OAAO,UAAU;EAE7C,MAAM,OACL,QAAQ,QACR,UAAU,gBAAgB;GAAE,OAAO;GAAS,GAAG,QAAQ;GAAM,CAAC,CAAC;EAEhE,MAAM,WAAW,CAChB,GAAG,SACH,QAAQ,cAAc,OAAO,UAC7B,CAAC,QAAQ,WAAW,OAAO,WAAW,SAAS;AAEhD,SAAO,EACN,OAAO,EACN,aAAa,sBAAsB,QAAQ,MAAM;;oBAEjC,kBAAkB,QAAQ,YAAY,CAAC;;;EAGzD,aAAa,OAAO,CAAC;;EAErB,CAAC,MAAM,UAAU,CAAC,OAAO,QAAQ,CAAC,KAAK,GAAG,CAAC;;;EAG3C,QAAQ,cAAc,OAAO,SAAS,aAAa,KAAK,OAAO,CAAC;;;;;UAKxD,QAAQ,MAAM;EACtB,CAAC,GAAG,UAAU,QAAQ,cAAc,OAAO,WAAW,CACtD,OAAO,QAAQ,CACf,KAAK,YAAY,KAAK,UAAU,CAChC,KAAK,GAAG,CAAC;EACT,SAAS,SAAS,KAAK,SAAS,KAAK,WAAW,OAAO,MAAM,CAAC,CAAC,KAAK,OAAO,KAAK,MAC9E,EACD;;CAEF,CAAC;AAEF,SAAS,YAAY,GAAU,GAAU;AACxC,QAAO,aAAa,EAAE,IAAI,CAAC,cAAc,aAAa,EAAE,IAAI,CAAC;;AAG9D,SAAS,YAAY,OAAc;CAClC,MAAM,QAAQ,aAAa,MAAM,IAAI,SAAS,MAAM,IAAI;CACxD,MAAM,SAAS,MAAM,OAClB,YAAY,MAAM,KAAK,oBAAoB,MAAM,QACjD;AAKH,QAAO,KAJW,MAAM,WACrB,GAAG,MAAM,SAAS,SAAS,SAAS,MAAM,SAAS,UACnD;;AAKJ,SAAS,aAAa,QAAiB;AACtC,QAAO,CACN,GAAG,QACH;EACC,KAAK;EACL,KAAK;EACL,CACD,CACC,KAAK,YAAY,CACjB,IAAI,YAAY,CAChB,KAAK,KAAK;;AAGb,SAAS,kBAAkB,aAAqB;AAC/C,KAAI,CAAC,YAAY,SAAS,KAAK,CAC9B,QAAO;AAGR,QAAO,QAAS,YAAY,WAAW,MAAM,OAAQ,GAAG;;AAGzD,SAAS,aAAa,MAAc;AACnC,QAAO,KAAK,WAAW,eAAe,GAAG,CAAC,MAAM"}