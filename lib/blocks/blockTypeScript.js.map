{"version":3,"file":"blockTypeScript.js","names":[],"sources":["../../src/blocks/blockTypeScript.ts"],"sourcesContent":["import sortKeys from \"sort-keys\";\nimport { CompilerOptionsSchema } from \"zod-tsconfig\";\n\nimport { base } from \"../base.js\";\nimport { getPackageDependencies } from \"../data/packageData.js\";\nimport { getPrimaryBin } from \"./bin/getPrimaryBin.js\";\nimport { blockDevelopmentDocs } from \"./blockDevelopmentDocs.js\";\nimport { blockExampleFiles } from \"./blockExampleFiles.js\";\nimport { blockGitHubActionsCI } from \"./blockGitHubActionsCI.js\";\nimport { blockGitignore } from \"./blockGitignore.js\";\nimport { blockKnip } from \"./blockKnip.js\";\nimport { blockPackageJson } from \"./blockPackageJson.js\";\nimport { blockRemoveWorkflows } from \"./blockRemoveWorkflows.js\";\nimport { blockVitest } from \"./blockVitest.js\";\nimport { blockVSCode } from \"./blockVSCode.js\";\nimport { intakeFileAsJson } from \"./intake/intakeFileAsJson.js\";\n\nexport const blockTypeScript = base.createBlock({\n\tabout: {\n\t\tname: \"TypeScript\",\n\t},\n\taddons: {\n\t\tcompilerOptions: CompilerOptionsSchema.optional(),\n\t},\n\tintake({ files }) {\n\t\tconst raw = intakeFileAsJson(files, [\"tsconfig.json\"]);\n\t\tconst { data } = CompilerOptionsSchema.safeParse(raw?.compilerOptions);\n\t\tif (!data) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn {\n\t\t\tcompilerOptions: data,\n\t\t};\n\t},\n\tproduce({ addons, options }) {\n\t\tconst { compilerOptions } = addons;\n\t\tconst primaryBin = getPrimaryBin(options.bin, options.repository);\n\n\t\treturn {\n\t\t\taddons: [\n\t\t\t\tblockDevelopmentDocs({\n\t\t\t\t\tsections: {\n\t\t\t\t\t\t\"Type Checking\": {\n\t\t\t\t\t\t\tcontents: `\nYou should be able to see suggestions from [TypeScript](https://typescriptlang.org) in your editor for all open files.\n\nHowever, it can be useful to run the TypeScript command-line (\\`tsc\\`) to type check all files in \\`src/\\`:\n\n\\`\\`\\`shell\npnpm tsc\n\\`\\`\\`\n\nAdd \\`--watch\\` to keep the type checker running in a watch mode that updates the display as you save files:\n\n\\`\\`\\`shell\npnpm tsc --watch\n\\`\\`\\`\n`,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tblockExampleFiles({\n\t\t\t\t\tfiles: {\n\t\t\t\t\t\t\"greet.ts\": `import { GreetOptions } from \"./types.js\";\n\t\n\texport function greet(options: GreetOptions | string) {\n\t\tconst {\n\t\t\tlogger = console.log.bind(console),\n\t\t\tmessage,\n\t\t\ttimes = 1,\n\t\t} = typeof options === \"string\" ? { message: options } : options;\n\t\n\t\tfor (let i = 0; i < times; i += 1) {\n\t\t\tlogger(message);\n\t\t}\n\t}\n\t`,\n\t\t\t\t\t\t\"index.ts\": `export * from \"./greet.js\";\nexport * from \"./types.js\";\n`,\n\t\t\t\t\t\t\"types.ts\": `export interface GreetOptions {\n\t\tlogger?: (message: string) => void;\n\t\tmessage: string;\n\t\ttimes?: number;\n\t}\n\t`,\n\t\t\t\t\t},\n\t\t\t\t\tusage: [\n\t\t\t\t\t\t`\\`\\`\\`shell\nnpm i ${options.repository}\n\\`\\`\\`\n\\`\\`\\`ts\nimport { greet } from \"${options.repository}\";\n\ngreet(\"Hello, world! ${options.emoji}\");\n\\`\\`\\``,\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tblockGitignore({\n\t\t\t\t\tignores: [\"/lib\"],\n\t\t\t\t}),\n\t\t\t\tblockGitHubActionsCI({\n\t\t\t\t\tjobs: [{ name: \"Type Check\", steps: [{ run: \"pnpm tsc\" }] }],\n\t\t\t\t}),\n\t\t\t\tblockKnip({\n\t\t\t\t\tproject: [\"src/**/*.ts\"],\n\t\t\t\t}),\n\t\t\t\tblockPackageJson({\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tdevDependencies: getPackageDependencies(\"typescript\"),\n\t\t\t\t\t\tfiles: [\"lib/\"],\n\t\t\t\t\t\tscripts: {\n\t\t\t\t\t\t\ttsc: \"tsc\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tblockVitest({ coverage: { include: [\"src\"] }, exclude: [\"lib\"] }),\n\t\t\t\tblockVSCode({\n\t\t\t\t\tdebuggers: primaryBin\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tname: \"Debug Program\",\n\t\t\t\t\t\t\t\t\tpreLaunchTask: \"build\",\n\t\t\t\t\t\t\t\t\tprogram: primaryBin,\n\t\t\t\t\t\t\t\t\trequest: \"launch\",\n\t\t\t\t\t\t\t\t\tskipFiles: [\"<node_internals>/**\"],\n\t\t\t\t\t\t\t\t\ttype: \"node\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t: [],\n\t\t\t\t\tsettings: {\n\t\t\t\t\t\t\"typescript.tsdk\": \"node_modules/typescript/lib\",\n\t\t\t\t\t},\n\t\t\t\t\ttasks: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdetail: \"Build the project\",\n\t\t\t\t\t\t\tlabel: \"build\",\n\t\t\t\t\t\t\tscript: \"build\",\n\t\t\t\t\t\t\ttype: \"npm\",\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t\tfiles: {\n\t\t\t\t\"tsconfig.json\": JSON.stringify({\n\t\t\t\t\tcompilerOptions: sortKeys({\n\t\t\t\t\t\tdeclaration: true,\n\t\t\t\t\t\tdeclarationMap: true,\n\t\t\t\t\t\tesModuleInterop: true,\n\t\t\t\t\t\tmodule: \"NodeNext\",\n\t\t\t\t\t\tmoduleResolution: \"NodeNext\",\n\t\t\t\t\t\tnoEmit: true,\n\t\t\t\t\t\tresolveJsonModule: true,\n\t\t\t\t\t\tskipLibCheck: true,\n\t\t\t\t\t\tstrict: true,\n\t\t\t\t\t\ttarget: \"ES2022\",\n\t\t\t\t\t\t...compilerOptions,\n\t\t\t\t\t}),\n\t\t\t\t\tinclude: [\"src\"],\n\t\t\t\t}),\n\t\t\t},\n\t\t};\n\t},\n\ttransition() {\n\t\treturn {\n\t\t\taddons: [\n\t\t\t\tblockRemoveWorkflows({\n\t\t\t\t\tworkflows: [\"tsc\"],\n\t\t\t\t}),\n\t\t\t],\n\t\t};\n\t},\n});\n"],"mappings":";;;;;;;;;;;;;;;;;AAiBA,MAAa,kBAAkB,KAAK,YAAY;CAC/C,OAAO,EACN,MAAM,cACN;CACD,QAAQ,EACP,iBAAiB,sBAAsB,UAAU,EACjD;CACD,OAAO,EAAE,SAAS;EACjB,MAAM,MAAM,iBAAiB,OAAO,CAAC,gBAAgB,CAAC;EACtD,MAAM,EAAE,SAAS,sBAAsB,UAAU,KAAK,gBAAgB;AACtE,MAAI,CAAC,KACJ;AAGD,SAAO,EACN,iBAAiB,MACjB;;CAEF,QAAQ,EAAE,QAAQ,WAAW;EAC5B,MAAM,EAAE,oBAAoB;EAC5B,MAAM,aAAa,cAAc,QAAQ,KAAK,QAAQ,WAAW;AAEjE,SAAO;GACN,QAAQ;IACP,qBAAqB,EACpB,UAAU,EACT,iBAAiB,EAChB,UAAU;;;;;;;;;;;;;;GAeV,EACD,EACD,CAAC;IACF,kBAAkB;KACjB,OAAO;MACN,YAAY;;;;;;;;;;;;;;MAcZ,YAAY;;;MAGZ,YAAY;;;;;;MAMZ;KACD,OAAO,CACN;QACE,QAAQ,WAAW;;;yBAGF,QAAQ,WAAW;;uBAErB,QAAQ,MAAM;QAE/B;KACD,CAAC;IACF,eAAe,EACd,SAAS,CAAC,OAAO,EACjB,CAAC;IACF,qBAAqB,EACpB,MAAM,CAAC;KAAE,MAAM;KAAc,OAAO,CAAC,EAAE,KAAK,YAAY,CAAC;KAAE,CAAC,EAC5D,CAAC;IACF,UAAU,EACT,SAAS,CAAC,cAAc,EACxB,CAAC;IACF,iBAAiB,EAChB,YAAY;KACX,iBAAiB,uBAAuB,aAAa;KACrD,OAAO,CAAC,OAAO;KACf,SAAS,EACR,KAAK,OACL;KACD,EACD,CAAC;IACF,YAAY;KAAE,UAAU,EAAE,SAAS,CAAC,MAAM,EAAE;KAAE,SAAS,CAAC,MAAM;KAAE,CAAC;IACjE,YAAY;KACX,WAAW,aACR,CACA;MACC,MAAM;MACN,eAAe;MACf,SAAS;MACT,SAAS;MACT,WAAW,CAAC,sBAAsB;MAClC,MAAM;MACN,CACD,GACA,EAAE;KACL,UAAU,EACT,mBAAmB,+BACnB;KACD,OAAO,CACN;MACC,QAAQ;MACR,OAAO;MACP,QAAQ;MACR,MAAM;MACN,CACD;KACD,CAAC;IACF;GACD,OAAO,EACN,iBAAiB,KAAK,UAAU;IAC/B,iBAAiB,SAAS;KACzB,aAAa;KACb,gBAAgB;KAChB,iBAAiB;KACjB,QAAQ;KACR,kBAAkB;KAClB,QAAQ;KACR,mBAAmB;KACnB,cAAc;KACd,QAAQ;KACR,QAAQ;KACR,GAAG;KACH,CAAC;IACF,SAAS,CAAC,MAAM;IAChB,CAAC,EACF;GACD;;CAEF,aAAa;AACZ,SAAO,EACN,QAAQ,CACP,qBAAqB,EACpB,WAAW,CAAC,MAAM,EAClB,CAAC,CACF,EACD;;CAEF,CAAC"}