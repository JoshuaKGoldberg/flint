{"version":3,"file":"blockPrettier.js","names":[],"sources":["../../src/blocks/blockPrettier.ts"],"sourcesContent":["import { z } from \"zod\";\n\nimport { base } from \"../base.js\";\nimport { getPackageDependencies } from \"../data/packageData.js\";\nimport { blockCSpell } from \"./blockCSpell.js\";\nimport { blockDevelopmentDocs } from \"./blockDevelopmentDocs.js\";\nimport { blockGitHubActionsCI } from \"./blockGitHubActionsCI.js\";\nimport { blockPackageJson } from \"./blockPackageJson.js\";\nimport { blockRemoveDependencies } from \"./blockRemoveDependencies.js\";\nimport { blockRemoveFiles } from \"./blockRemoveFiles.js\";\nimport { blockRemoveWorkflows } from \"./blockRemoveWorkflows.js\";\nimport { blockVSCode } from \"./blockVSCode.js\";\nimport { formatIgnoreFile } from \"./files/formatIgnoreFile.js\";\nimport { CommandPhase } from \"./phases.js\";\n\nexport const blockPrettier = base.createBlock({\n\tabout: {\n\t\tname: \"Prettier\",\n\t},\n\taddons: {\n\t\tignores: z.array(z.string()).default([]),\n\t\toverrides: z\n\t\t\t.array(\n\t\t\t\tz.object({\n\t\t\t\t\tfiles: z.string(),\n\t\t\t\t\toptions: z.object({\n\t\t\t\t\t\tparser: z.string(),\n\t\t\t\t\t}),\n\t\t\t\t}),\n\t\t\t)\n\t\t\t.default([]),\n\t\tplugins: z.array(z.string()).default([]),\n\t\trunBefore: z.array(z.string()).default([]),\n\t},\n\tproduce({ addons }) {\n\t\tconst { ignores, overrides, plugins, runBefore } = addons;\n\n\t\treturn {\n\t\t\taddons: [\n\t\t\t\tblockCSpell({\n\t\t\t\t\tignorePaths: [\".all-contributorsrc\"],\n\t\t\t\t}),\n\t\t\t\tblockDevelopmentDocs({\n\t\t\t\t\tsections: {\n\t\t\t\t\t\tFormatting: {\n\t\t\t\t\t\t\tcontents: `\n[Prettier](https://prettier.io) is used to format code.\nIt should be applied automatically when you save files in VS Code or make a Git commit.\n\nTo manually reformat all files, you can run:\n\n\\`\\`\\`shell\npnpm format --write\n\\`\\`\\`\n`,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tblockGitHubActionsCI({\n\t\t\t\t\tjobs: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"Prettier\",\n\t\t\t\t\t\t\tsteps: [\n\t\t\t\t\t\t\t\t...runBefore.map((run) => ({ run })),\n\t\t\t\t\t\t\t\t{ run: \"pnpm format --list-different\" },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tblockPackageJson({\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tdevDependencies: getPackageDependencies(\n\t\t\t\t\t\t\t...plugins.filter((plugin) => !plugin.startsWith(\".\")),\n\t\t\t\t\t\t\t\"husky\",\n\t\t\t\t\t\t\t\"lint-staged\",\n\t\t\t\t\t\t\t\"prettier\",\n\t\t\t\t\t\t),\n\t\t\t\t\t\t\"lint-staged\": {\n\t\t\t\t\t\t\t\"*\": \"prettier --ignore-unknown --write\",\n\t\t\t\t\t\t},\n\t\t\t\t\t\tscripts: {\n\t\t\t\t\t\t\tformat: \"prettier .\",\n\t\t\t\t\t\t\tprepare: \"husky\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tblockVSCode({\n\t\t\t\t\textensions: [\"esbenp.prettier-vscode\"],\n\t\t\t\t\tsettings: { \"editor.defaultFormatter\": \"esbenp.prettier-vscode\" },\n\t\t\t\t}),\n\t\t\t],\n\t\t\tfiles: {\n\t\t\t\t\".husky\": {\n\t\t\t\t\t\".gitignore\": \"_\\n\",\n\t\t\t\t\t\"pre-commit\": [\"npx lint-staged\\n\", { executable: true }],\n\t\t\t\t},\n\t\t\t\t\".prettierignore\": formatIgnoreFile(\n\t\t\t\t\t[\"/.husky\", \"/lib\", \"/pnpm-lock.yaml\", ...ignores].sort(),\n\t\t\t\t),\n\t\t\t\t\".prettierrc.json\": JSON.stringify({\n\t\t\t\t\t$schema: \"http://json.schemastore.org/prettierrc\",\n\t\t\t\t\t...(overrides.length && { overrides: overrides.sort() }),\n\t\t\t\t\t...(plugins.length && { plugins: plugins.sort() }),\n\t\t\t\t\tuseTabs: true,\n\t\t\t\t}),\n\t\t\t},\n\t\t\tscripts: [\n\t\t\t\t{\n\t\t\t\t\tcommands: [...runBefore, \"pnpm format --write\"],\n\t\t\t\t\tphase: CommandPhase.Format,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t},\n\ttransition() {\n\t\treturn {\n\t\t\taddons: [\n\t\t\t\tblockRemoveDependencies({\n\t\t\t\t\tdependencies: [\"eslint-config-prettier\", \"eslint-plugin-prettier\"],\n\t\t\t\t}),\n\t\t\t\tblockRemoveFiles({\n\t\t\t\t\tfiles: [\n\t\t\t\t\t\t\".prettierrc\",\n\t\t\t\t\t\t\".prettierrc.{c*,js,m*,t*}\",\n\t\t\t\t\t\t\"prettier.config*\",\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tblockRemoveWorkflows({\n\t\t\t\t\tworkflows: [\"format\", \"prettier\"],\n\t\t\t\t}),\n\t\t\t],\n\t\t};\n\t},\n});\n"],"mappings":";;;;;;;;;;;;;;;AAeA,MAAa,gBAAgB,KAAK,YAAY;CAC7C,OAAO,EACN,MAAM,YACN;CACD,QAAQ;EACP,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EACxC,WAAW,EACT,MACA,EAAE,OAAO;GACR,OAAO,EAAE,QAAQ;GACjB,SAAS,EAAE,OAAO,EACjB,QAAQ,EAAE,QAAQ,EAClB,CAAC;GACF,CAAC,CACF,CACA,QAAQ,EAAE,CAAC;EACb,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EACxC,WAAW,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;EAC1C;CACD,QAAQ,EAAE,UAAU;EACnB,MAAM,EAAE,SAAS,WAAW,SAAS,cAAc;AAEnD,SAAO;GACN,QAAQ;IACP,YAAY,EACX,aAAa,CAAC,sBAAsB,EACpC,CAAC;IACF,qBAAqB,EACpB,UAAU,EACT,YAAY,EACX,UAAU;;;;;;;;;GAUV,EACD,EACD,CAAC;IACF,qBAAqB,EACpB,MAAM,CACL;KACC,MAAM;KACN,OAAO,CACN,GAAG,UAAU,KAAK,SAAS,EAAE,KAAK,EAAE,EACpC,EAAE,KAAK,gCAAgC,CACvC;KACD,CACD,EACD,CAAC;IACF,iBAAiB,EAChB,YAAY;KACX,iBAAiB,uBAChB,GAAG,QAAQ,QAAQ,WAAW,CAAC,OAAO,WAAW,IAAI,CAAC,EACtD,SACA,eACA,WACA;KACD,eAAe,EACd,KAAK,qCACL;KACD,SAAS;MACR,QAAQ;MACR,SAAS;MACT;KACD,EACD,CAAC;IACF,YAAY;KACX,YAAY,CAAC,yBAAyB;KACtC,UAAU,EAAE,2BAA2B,0BAA0B;KACjE,CAAC;IACF;GACD,OAAO;IACN,UAAU;KACT,cAAc;KACd,cAAc,CAAC,qBAAqB,EAAE,YAAY,MAAM,CAAC;KACzD;IACD,mBAAmB,iBAClB;KAAC;KAAW;KAAQ;KAAmB,GAAG;KAAQ,CAAC,MAAM,CACzD;IACD,oBAAoB,KAAK,UAAU;KAClC,SAAS;KACT,GAAI,UAAU,UAAU,EAAE,WAAW,UAAU,MAAM,EAAE;KACvD,GAAI,QAAQ,UAAU,EAAE,SAAS,QAAQ,MAAM,EAAE;KACjD,SAAS;KACT,CAAC;IACF;GACD,SAAS,CACR;IACC,UAAU,CAAC,GAAG,WAAW,sBAAsB;IAC/C,OAAO,aAAa;IACpB,CACD;GACD;;CAEF,aAAa;AACZ,SAAO,EACN,QAAQ;GACP,wBAAwB,EACvB,cAAc,CAAC,0BAA0B,yBAAyB,EAClE,CAAC;GACF,iBAAiB,EAChB,OAAO;IACN;IACA;IACA;IACA,EACD,CAAC;GACF,qBAAqB,EACpB,WAAW,CAAC,UAAU,WAAW,EACjC,CAAC;GACF,EACD;;CAEF,CAAC"}