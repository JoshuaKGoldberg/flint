{"version":3,"file":"createMultiWorkflowFile.js","names":[],"sources":["../../../src/blocks/files/createMultiWorkflowFile.ts"],"sourcesContent":["import { WorkflowsVersions } from \"../../schemas.js\";\nimport { resolveUses } from \"../actions/resolveUses.js\";\nimport { createJobName } from \"./createJobName.js\";\nimport { formatWorkflowYaml } from \"./formatWorkflowYaml.js\";\n\nexport interface MultiWorkflowFileOptions {\n\tjobs: MultiWorkflowJobOptions[];\n\tname: string;\n\tworkflowsVersions: undefined | WorkflowsVersions;\n}\n\nexport interface MultiWorkflowJobOptions {\n\tcheckoutWith?: Record<string, string>;\n\tif?: string;\n\tname: string;\n\tsteps: MultiWorkflowJobStep[];\n}\n\nexport type MultiWorkflowJobStep = { if?: string } & (\n\t| { run: string }\n\t| { uses: string }\n);\n\nexport function createMultiWorkflowFile({\n\tjobs,\n\tname,\n\tworkflowsVersions,\n}: MultiWorkflowFileOptions) {\n\treturn formatWorkflowYaml({\n\t\tjobs: Object.fromEntries(\n\t\t\tjobs.map((job) => [\n\t\t\t\tcreateJobName(job.name),\n\t\t\t\t{\n\t\t\t\t\tif: job.if,\n\t\t\t\t\tname: job.name,\n\t\t\t\t\t\"runs-on\": \"ubuntu-latest\",\n\t\t\t\t\tsteps: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuses: resolveUses(\"actions/checkout\", \"v4\", workflowsVersions),\n\t\t\t\t\t\t\twith: job.checkoutWith,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ uses: \"./.github/actions/prepare\" },\n\t\t\t\t\t\t...job.steps,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t]),\n\t\t),\n\t\tname,\n\t\ton: {\n\t\t\tpull_request: null,\n\t\t\tpush: {\n\t\t\t\tbranches: [\"main\"],\n\t\t\t},\n\t\t},\n\t});\n}\n"],"mappings":";;;;;AAuBA,SAAgB,wBAAwB,EACvC,MACA,MACA,qBAC4B;AAC5B,QAAO,mBAAmB;EACzB,MAAM,OAAO,YACZ,KAAK,KAAK,QAAQ,CACjB,cAAc,IAAI,KAAK,EACvB;GACC,IAAI,IAAI;GACR,MAAM,IAAI;GACV,WAAW;GACX,OAAO;IACN;KACC,MAAM,YAAY,oBAAoB,MAAM,kBAAkB;KAC9D,MAAM,IAAI;KACV;IACD,EAAE,MAAM,6BAA6B;IACrC,GAAG,IAAI;IACP;GACD,CACD,CAAC,CACF;EACD;EACA,IAAI;GACH,cAAc;GACd,MAAM,EACL,UAAU,CAAC,OAAO,EAClB;GACD;EACD,CAAC"}