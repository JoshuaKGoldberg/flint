{"version":3,"file":"steps.js","names":[],"sources":["../../../src/blocks/actions/steps.ts"],"sourcesContent":["import { IntakeDirectory } from \"bingo-fs\";\nimport _ from \"lodash\";\nimport { z } from \"zod\";\n\nimport { intakeFileAsYaml } from \"../intake/intakeFileAsYaml.js\";\n\nexport const zActionStep = z.intersection(\n\tz.object({\n\t\tenv: z.record(z.string(), z.string()).optional(),\n\t\tif: z.string().optional(),\n\t\twith: z.record(z.string(), z.string()).optional(),\n\t}),\n\tz.union([z.object({ run: z.string() }), z.object({ uses: z.string() })]),\n);\n\nexport interface JobOrRunStep {\n\tenv?: Record<string, string>;\n\tuses?: unknown;\n\twith?: Record<string, string>;\n}\n\nexport function intakeFileYamlSteps(\n\tfiles: IntakeDirectory,\n\tfilePath: string[],\n\tymlPath: string[],\n) {\n\tconst actionYml = intakeFileAsYaml(files, filePath);\n\tif (!actionYml) {\n\t\treturn undefined;\n\t}\n\n\tconst steps = _.get(actionYml, ymlPath) as JobOrRunStep[] | undefined;\n\tif (!steps || !Array.isArray(steps)) {\n\t\treturn undefined;\n\t}\n\n\treturn steps;\n}\n"],"mappings":";;;;;AAMA,MAAa,cAAc,EAAE,aAC5B,EAAE,OAAO;CACR,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,EAAE,QAAQ,CAAC,CAAC,UAAU;CAChD,IAAI,EAAE,QAAQ,CAAC,UAAU;CACzB,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,EAAE,QAAQ,CAAC,CAAC,UAAU;CACjD,CAAC,EACF,EAAE,MAAM,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC,CACxE;AAQD,SAAgB,oBACf,OACA,UACA,SACC;CACD,MAAM,YAAY,iBAAiB,OAAO,SAAS;AACnD,KAAI,CAAC,UACJ;CAGD,MAAM,QAAQ,EAAE,IAAI,WAAW,QAAQ;AACvC,KAAI,CAAC,SAAS,CAAC,MAAM,QAAQ,MAAM,CAClC;AAGD,QAAO"}